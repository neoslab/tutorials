## Introduction

Mastering SQLmap can be challenging, especially if you're new to it. This comprehensive SQLmap tutorial aims to present the most crucial functionalities of this popular SQL injection tool in a detailed and straightforward manner. By the end of this guide, you will have a solid understanding of how to use SQLmap for various penetration testing tasks.

Before using SQLmap, you need to ensure you have the latest release of the tool and a Python interpreter installed. Most Linux distributions come with Python pre-installed. However, if you're not using Linux or if Python is not installed, you will need to download and install it. Additionally, you will need a vulnerable website to test. In this tutorial, we will use our simulation environment hosted on a local machine, accessible via port 8888.

SQLmap is an open-source penetration testing tool that automates the process of detecting and exploiting SQL injection vulnerabilities and taking control of database servers. It features a powerful detection engine, numerous niche features for advanced penetration testers, and a broad range of options, from database fingerprinting and data extraction to accessing the underlying file system and executing commands on the operating system via out-of-band connections.

* * *

## How Can You Use SQLmap?

### Installation

First, if SQLmap is not yet installed on your machine, you can visit the [official website](http://sqlmap.org/) to check for the latest version and download the tool. Keep in mind that SQLmap is a Python-based tool, which means it requires Python to be installed on your machine. To get started, download the tool, unpack it, and run the command with the necessary options.

If you are using Microsoft Windows as your main operating system, you might find it most convenient to run Parrot Security or Kali Linux in a virtual machine. These Linux distributions come pre-installed with SQLmap, Nmap, Nikto, and hundreds of other powerful open-source security tools.

### Features

SQLmap offers extensive features, including:

- Full support for various database management systems, including **MySQL, Oracle, PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird, Sybase, SAP MaxDB, HSQLDB, and Informix**.
- Full support for six SQL injection techniques: **boolean-based blind, time-based blind, error-based, UNION query-based, stacked queries, and out-of-band**.
- The ability to **directly connect to a database** without passing through an SQL injection, by providing DBMS credentials, IP address, port, and database name.
- Support for enumerating **users, password hashes, privileges, roles, databases, tables, and columns**.
- Automatic recognition of password hash formats and support for **cracking them using a dictionary-based attack**.
- The capability to **dump database tables** entirely, a range of entries, or specific columns as per user’s choice. Users can also choose to dump only a range of characters from each column’s entry.
- Support for **searching specific database names, specific tables across all databases, or specific columns across all databases’ tables**. This is useful for identifying tables containing custom application credentials where relevant column names contain strings like "name" and "pass".
- The ability to **download and upload any file** from the database server's underlying file system when the database software is MySQL, PostgreSQL, or Microsoft SQL Server.
- Support for **executing arbitrary commands and retrieving their standard output** on the database server's underlying operating system when the database software is MySQL, PostgreSQL, or Microsoft SQL Server.
- The ability to **establish an out-of-band stateful TCP connection between the attacker machine and the database server's underlying operating system**. This channel can be an interactive command prompt, a Meterpreter session, or a graphical user interface (VNC) session as per user’s choice.
- Support for **database process user privilege escalation** via Metasploit’s Meterpreter “`getsystem`” command.

* * *

## Download SQLmap

### Step 1: Get a Linux-based Operating System

If you are running SQLmap on Windows with Python, ensure Python is installed and proceed to the next step. Otherwise, start your Linux system. You can either install a Linux virtual machine (Ubuntu or Kali recommended) on Windows using VirtualBox, VMware, or Parallels, or boot up your Linux desktop.

### Step 2: SQLmap Installation

For Ubuntu users, Python is pre-installed, so all you need to do is download SQLmap from Sourceforge, unpack it into a directory, and start testing. Alternatively, if you have git installed, you can clone the latest copy with the command below. You can also download the latest ZIP file from SQLmap’s official website.

```html
git clone --depth 1 https://github.com/sqlmapproject/sqlmap.git sqlmap
cd sqlmap
python sqlmap.py
```

**Output**

![Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation](https://neoslab.com/uploads/medias/2022/03/comprehensive-sqlmap-tutorial-sql-injection-detection-and-exploitation-1.png "Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation")

If you do not see an output similar to the one above, ensure Python is working by using “`python -V`” to check the version and verify you are in the correct directory. This step completes the basic setup.

To get a full list of the available options, run “`python sqlmap.py -h`“.

* * *

## Running SQLmap

### Simple HTTP GET Based Test

In this simple test, we will use a standard **HTTP GET** request against a URI with a parameter (e.g., ?id=5). This test will check for different SQL injection methods against the **id** parameter.

```html
python sqlmap.py -u 'http://mytestsite.com/page.php?id=5'
```

The results will display the different methods used against the parameter.

![Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation](https://neoslab.com/uploads/medias/2022/03/comprehensive-sqlmap-tutorial-sql-injection-detection-and-exploitation-2.png "Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation")

### Retrieve The Database Tables

SQLmap can be used to test and exploit SQL injection vulnerabilities, enabling tasks such as extracting data from databases, updating tables, and even **popping shells on remote hosts** if conditions are favorable.

To retrieve the tables from the database using the SQL injection vulnerability confirmed earlier, add the “`--tables`” parameter to the previous command. SQLmap will use the information it has gathered about the site to further exploit the target database.

```html
python sqlmap.py -u 'http://mytestsite.com/page.php?id=5' --tables
```

![Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation](https://neoslab.com/uploads/medias/2022/03/comprehensive-sqlmap-tutorial-sql-injection-detection-and-exploitation-3.png "Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation")

### Dump The Data

To extract data, extend the command with additional parameters. Adding “`-T user`” will focus on the “user” table, potentially revealing credentials. Adding “`--dump`” will instruct SQLmap to retrieve all data from the “user” table. Initially, the columns will be enumerated, followed by dumping the data from these columns.

```html
python sqlmap.py -u 'http://mytestsite.com/page.php?id=5' --columns -D DATABASE-NAME -T TABLE-NAME --dump
```

![Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation](https://neoslab.com/uploads/medias/2022/03/comprehensive-sqlmap-tutorial-sql-injection-detection-and-exploitation-4.png "Comprehensive SQLmap Tutorial - SQL Injection Detection and Exploitation")

* * *

## SQLmap Tips

### Verbose Output

When testing for SQL injection, it is often necessary to manually inspect the requests to identify problems or further exploit a discovered vulnerability. Increasing the verbosity of your SQLmap output can assist with this process. By setting the verbosity level to 4, you can view the HTTP requests. Setting it to 5 includes the HTTP response headers, and 6 will show the full HTTP response. Although this can be quite detailed, it is sometimes essential to see what is happening.

### Got Database Credentials?

This tip allows you to connect to the database directly and dump data such as users, databases, or tables. The benefit of this method is that you do not need to remember the SQL syntax for the database or have a client installed. SQLmap handles the complexities, acting as a database client to dump data.

### DB Connection Strings

- MySQL, Oracle, Microsoft SQL Server, PostgreSQL:

```html
DBMS://USER:PASSWORD@DBMS_IP:DBMS_PORT/DATABASE_NAME
```

- SQLite, Microsoft Access:

```html
DBMS://DATABASE_FILEPATH
```

### Popping Shells and More

SQLmap offers numerous options and is an excellent tool for interacting with databases. Besides popping shells on the target host, you can send requests through Tor, find injections in page responses automatically, spider sites, and perform HTTP POST-based testing. These examples only scratch the surface; more detailed examples are available on the [excellent GitHub wiki page](https://github.com/sqlmapproject/sqlmap/wiki).

**Source:** [hackertarget.com](http://web.archive.org/web/20221227112216/https://hackertarget.com/sqlmap-tutorial/)

* * *

## Conclusion

SQLmap is an indispensable tool for penetration testers and ethical hackers, offering a wide array of features for detecting and exploiting SQL injection vulnerabilities. Its powerful detection engine, combined with the ability to perform various